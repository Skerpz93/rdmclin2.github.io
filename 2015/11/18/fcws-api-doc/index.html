<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 凤城卫士API文档 · Mcl's space</title><meta name="description" content="凤城卫士API文档 - LinChen"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.ico"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/rdmclin2" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/rdmclin2" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">凤城卫士API文档</h1><div class="post-time">Nov 18, 2015</div><div class="post-content"><blockquote>
<p>本篇为凤城卫士的API文档，包括其url,接受的参数，示例url以及返回值示例。对于REST API的 设计感兴趣的可以移步<a href="http://mclspace.com/2015/11/03/restful-note/" target="_blank" rel="external">这篇文章</a></p>
</blockquote>
<p>注: 本篇中的url均具有前缀 <em>/api/v1</em> ,这里为简便起见，进行了省略.</p>
<a id="more"></a>
<h1 id="用户信息">用户信息</h1><h2 id="授权验证_<!-这边应该POST,因为重新生成了token_->">授权验证 <!--这边应该POST,因为重新生成了token --></h2><p><code>/auth/local</code> GET 验证用户名密码，并重新生成token，返回基本的用户信息<br>接受参数:</p>
<ul>
<li>id     String 用户id</li>
<li>password         String 用户密码</li>
</ul>
<p>示例 : <code>GET localhost:3000/api/v1/auth/local?id=44220&amp;password=44220</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#10;  &#34;id&#34;: &#34;44220&#34;,&#10;  &#34;role&#34;: &#34;high-level&#34;,&#10;  &#34;description&#34;: &#34;&#24178;&#20107;1&#34;,&#10;  &#34;name&#34;: &#34;&#34;,&#10;  &#34;accessToken&#34;: &#34;d827b0ef-4e21-4cb7-b89f-c0b601fbe4b1&#34;&#10;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="重置密码_<!-这边应该用PUT_,因为用户更新了密码_->">重置密码 <!--这边应该用PUT ,因为用户更新了密码 --></h2><p> <code>/users/changePassword</code> POST 重置用户密码，重新生成盐值和hash存储到数据库中，返回修改后的用户基本信息<br>接受参数:</p>
<ul>
<li>id     String 用户id</li>
<li>password         String 用户密码</li>
<li>new_password         String 新的用户密码</li>
</ul>
<p>示例 : <code>POST localhost:3000/api/v1/users/changePassword</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#10;  &#34;id&#34;: &#34;44220&#34;,&#10;  &#34;role&#34;: &#34;high-level&#34;,&#10;  &#34;description&#34;: &#34;&#24178;&#20107;1&#34;,&#10;  &#34;name&#34;: &#34;&#34;,&#10;  &#34;accessToken&#34;: &#34;d827b0ef-4e21-4cb7-b89f-c0b601fbe4b1&#34;&#10;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="获得用户信息_//这边应该用/users/:id">获得用户信息 //这边应该用/users/:id</h2><p><code>/users/details</code> GET 获取用户详细信息,如最近的主题以及最近的回复</p>
<p>接受参数:</p>
<ul>
<li>access_token         String 用户的token</li>
</ul>
<p>示例 :  <code>GET localhost:3000/api/v1/users/details?access_token=e25be7a2-0553-4104-a210-bde3873bfdb6</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#10;  &#34;id&#34;: &#34;13852862738&#34;,&#10;  &#34;role&#34;: &#34;low-level&#34;,&#10;  &#34;description&#34;: &#34;&#28023;&#38517;&#21306;&#22478;&#35199;&#34903;&#36947;&#24773;&#25253;&#21592;&#34;,&#10;  &#34;name&#34;: &#34;&#39640;&#26376;&#34;,&#10;  &#34;recent_posts&#34;: [&#10;    &#123;&#10;      &#34;_id&#34;: &#34;564aef7bd443b5243c7e826b&#34;,&#10;      &#34;author_id&#34;: &#34;13852862738&#34;,&#10;      &#34;content&#34;: &#34;&#27979;&#35797;&#24773;&#25253;&#34;,&#10;      &#34;important&#34;: false,&#10;      &#34;create_at&#34;: &#34;2015-11-17T09:12:27.217Z&#34;&#10;    &#125;&#10;  ],&#10;  &#34;recent_replies&#34;: [&#10;    &#123;&#10;      &#34;_id&#34;: &#34;564aef8fd443b5243c7e826d&#34;,&#10;      &#34;author_id&#34;: &#34;13852862738&#34;,&#10;      &#34;content&#34;: &#34;&#21621;&#21621;&#34;,&#10;      &#34;create_at&#34;: &#34;2015-11-17T09:12:47.664Z&#34;&#10;    &#125;,&#10;    &#123;&#10;      &#34;_id&#34;: &#34;564aef85d443b5243c7e826c&#34;,&#10;      &#34;author_id&#34;: &#34;13852862738&#34;,&#10;      &#34;content&#34;: &#34;&#35780;&#35770;&#19968;&#20010;&#34;,&#10;      &#34;create_at&#34;: &#34;2015-11-17T09:12:37.741Z&#34;&#10;    &#125;&#10;  ]&#10;&#125;</span><br></pre></td></tr></table></figure>
<h1 id="情报信息">情报信息</h1><h2 id="获取情报列表">获取情报列表</h2><p><code>/posts</code> GET 获取帖子列表</p>
<p>接受参数:</p>
<ul>
<li>limit     Number 每页的情报数量</li>
<li>page         Number 页数</li>
<li>access_token         String 用户的token</li>
</ul>
<p>示例: <code>GET localhost:3000/api/v1/posts?access_token=e25be7a2-0553-4104-a210-bde3873bfdb6&amp;limit=5&amp;page=1</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#10;  &#123;&#10;    &#34;_id&#34;: &#34;564aef7bd443b5243c7e826b&#34;,&#10;    &#34;author_id&#34;: &#34;13852862738&#34;,&#10;    &#34;content&#34;: &#34;&#27979;&#35797;&#24773;&#25253;&#34;,&#10;    &#34;important&#34;: false,&#10;    &#34;create_at&#34;: &#34;2015-11-17T09:12:27.217Z&#34;,&#10;    &#34;author&#34;: &#123;&#10;      &#34;name&#34;: &#34;&#39640;&#26376;&#34;&#10;    &#125;&#10;  &#125;,&#10;  &#123;&#10;    &#34;_id&#34;: &#34;564ae2c08bb772bf39386e2b&#34;,&#10;    &#34;author_id&#34;: &#34;44121&#34;,&#10;    &#34;content&#34;: &#34;hello&#34;,&#10;    &#34;important&#34;: true,&#10;    &#34;create_at&#34;: &#34;2015-11-17T08:18:08.800Z&#34;,&#10;    &#34;author&#34;: &#123;&#10;      &#34;name&#34;: &#34;&#34;&#10;    &#125;&#10;  &#125;&#10;]</span><br></pre></td></tr></table></figure>
<h2 id="获取某个帖子的具体内容">获取某个帖子的具体内容</h2><p><code>/posts/:id</code> GET 获取某个帖子的具体内容</p>
<p>接受参数:</p>
<ul>
<li>id    String 帖子的id</li>
<li>access_token         String 用户的token</li>
</ul>
<p>示例: <code>GET localhost:3000/api/v1/posts/564aef7bd443b5243c7e826b?access_token=e25be7a2-0553-4104-a210-bde3873bfdb6</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#10;  &#34;_id&#34;: &#34;564aef7bd443b5243c7e826b&#34;,&#10;  &#34;author_id&#34;: &#34;13852862738&#34;,&#10;  &#34;content&#34;: &#34;&#27979;&#35797;&#24773;&#25253;&#34;,&#10;  &#34;important&#34;: false,&#10;  &#34;photos&#34;: [],&#10;  &#34;create_at&#34;: &#34;2015-11-17T09:12:27.217Z&#34;,&#10;  &#34;author&#34;: &#123;&#10;    &#34;name&#34;: &#34;&#39640;&#26376;&#34;&#10;  &#125;,&#10;  &#34;replies&#34;: [&#10;    &#123;&#10;      &#34;_id&#34;: &#34;564aef85d443b5243c7e826c&#34;,&#10;      &#34;author_id&#34;: &#34;13852862738&#34;,&#10;      &#34;post_id&#34;: &#34;564aef7bd443b5243c7e826b&#34;,&#10;      &#34;content&#34;: &#34;&#35780;&#35770;&#19968;&#20010;&#34;,&#10;      &#34;create_at&#34;: &#34;2015-11-17T09:12:37.741Z&#34;,&#10;      &#34;author&#34;: &#123;&#10;        &#34;name&#34;: &#34;&#39640;&#26376;&#34;&#10;      &#125;&#10;    &#125;,&#10;    &#123;&#10;      &#34;_id&#34;: &#34;564aef8fd443b5243c7e826d&#34;,&#10;      &#34;author_id&#34;: &#34;13852862738&#34;,&#10;      &#34;post_id&#34;: &#34;564aef7bd443b5243c7e826b&#34;,&#10;      &#34;content&#34;: &#34;&#21621;&#21621;&#34;,&#10;      &#34;create_at&#34;: &#34;2015-11-17T09:12:47.664Z&#34;,&#10;      &#34;author&#34;: &#123;&#10;        &#34;name&#34;: &#34;&#39640;&#26376;&#34;&#10;      &#125;&#10;    &#125;&#10;  ]&#10;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="创建情报">创建情报</h2><p><code>/posts</code> POST 创建情报，返回情报基本内容</p>
<p>参数: </p>
<ul>
<li>content    String 帖子的内容,不能为空</li>
<li>important     Boolean 是否为紧急情报，默认为false</li>
<li>photos     [String] 情报的配图，目前默认只能上传一张</li>
<li>access_token        String 用户的token</li>
</ul>
<p>示例: <code>POST localhost:3000/api/v1/posts?access_token=e25be7a2-0553-4104-a210-bde3873bfdb6</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#10;  &#34;_id&#34;: &#34;564c34da38cad35f288846c9&#34;,&#10;  &#34;author_id&#34;: &#34;13852862738&#34;,&#10;  &#34;content&#34;: &#34;&#27979;&#35797;&#28040;&#24687; from postman&#34;,&#10;  &#34;important&#34;: true,&#10;  &#34;create_at&#34;: &#34;2015-11-18T08:20:42.379Z&#34;&#10;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="删除情报">删除情报</h2><p><code>/posts/:id</code> DELETE 删除情报，返回空文档。</p>
<p>接受参数:</p>
<ul>
<li>id     String 待删除的情报的id</li>
<li>access_token         String 用户的token</li>
</ul>
<p>示例: <code>DELETE localhost:3000/api/v1/posts/564c34da38cad35f288846c9?access_token=e25be7a2-0553-4104-a210-bde3873bfdb6</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure>
<h1 id="回复">回复</h1><h2 id="创建回复">创建回复</h2><p><code>replys</code> POST 创建一个回复，返回该回复</p>
<p>接受参数:</p>
<ul>
<li>post_id         String  回复的情报的id</li>
<li>content         String  回复内容</li>
<li>access_token     String  用户的token</li>
</ul>
<p>示例: <code>POST localhost:3000/api/v1/replys?access_token=e25be7a2-0553-4104-a210-bde3873bfdb6</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#10;  &#34;_id&#34;: &#34;564c7234d1739e4f0b056796&#34;,&#10;  &#34;post_id&#34;: &#34; 564c65c34086d9a105d78243&#34;,&#10;  &#34;content&#34;: &#34;&#28155;&#21152;&#19968;&#26465;&#22238;&#22797;&#34;,&#10;  &#34;author_id&#34;: &#34;13852862738&#34;,&#10;  &#34;create_at&#34;: &#34;2015-11-18T12:42:28.692Z&#34;&#10;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="删除回复">删除回复</h2><p><code>replys/:id</code> DELETE 删除某个回复,返回空文档</p>
<p>接受参数:</p>
<ul>
<li>id String 该回复的id</li>
<li>access_token String 用户的token</li>
</ul>
<p>示例: <code>DELETE localhost:3000/api/v1/replys/564c7234d1739e4f0b056796?access_token=e25be7a2-0553-4104-a210-bde3873bfdb6</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure></div></article></div></section><footer><div class="paginator"><a href="/2015/11/23/nodejs-ionic-mongodb-docker-summary/" class="prev">上一篇</a><a href="/2015/11/14/bash-note/" class="next">下一篇</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'mcl';
var disqus_identifier = '2015/11/18/fcws-api-doc/';
var disqus_title = '凤城卫士API文档';
var disqus_url = 'http://www.mclspace.com/2015/11/18/fcws-api-doc/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//mcl.disqus.com/count.js" async></script><div class="copyright"><p>© 2015 - 2016 <a href="http://www.mclspace.com">LinChen</a>, unless otherwise noted.</p></div></footer><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "//hm.baidu.com/hm.js?6b26d13232555e4d64b5a8c3567ccda9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script src="https://cdn.bootcss.com/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>